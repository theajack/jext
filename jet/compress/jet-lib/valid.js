!function(){var u=Jet.__base__;Jet.__base__._useList.push("valid");var i=u._JT,_="Jform",s="Jvalid",d=null,J=null;function t(e){n(e),e._JT_removeAttr("jvalid jet-value")}function n(e){e._JT_hasClass("jet-unpass")&&e._JT_removeClass("jet-unpass")._JT_val(e._JT_validValue)}function v(e){!0===e._JT_ispw&&e._JT_attr("type","password")}function f(e,t,n){if(null===(e=u._getJdomEle(e)).offsetParent)return"true";var l=e._JT_attr(s),a="";if(null!=l){if(-1!=l.indexOf("lengthOfAny")){var r=l.substring(12,l.length-1).split(",");void 0===r[1]&&(r[1]=r[0]);var i=e._JT_content();a=i.length>=parseInt(r[0])&&i.length<=parseInt(r[1])?"true":p("lengthOfAny",r)}else a=function(e,t){if(-1!=e.indexOf("notnull")){if(0==t.length)return o("notnull")}else if(-1!=e.indexOf("null")){var n=e.split(" "),l="null"==n[0]?n[1]:n[0];if(-1!=l.indexOf("range")){var a=T(e,t);if("true"!=a&&""!=t)return a}if(!c(l).test(t)&&""!=t)return o(l)}else if(-1!=e.indexOf("range")){var a=T(e,t);if("true"!=a)return a}else if(!c(e).test(t))return o(e);return"true"}(l,e._JT_content());"true"==a?(Jet.valid.__default&&(e._JT_removeClass("jet-unpass"),e._JT_validValue=void 0,v(e)),null!=d&&d(e)):(null!=J&&J(e,a),Jet.valid.__default&&(!0===n&&(e._JT_validValue=e._JT_content()),e._JT_content(a)._JT_addClass("jet-unpass"),"password"==e._JT_attr("type")&&(e._JT_ispw=!0,e._JT_attr("type","text"))),!1!==t&&(Jet.valid.useJUI?JUI.msg.error(a):Jet.valid.useAlert&&alert(a)))}return a}function l(e){"string"==typeof e&&(e={ele:e});var t=e.ele;"string"==typeof t&&((t=i.attr(_+"="+t))._JT_exist()||(t=u._getJdomEle(e.ele)));var l=[],a=!0;null==e.fail&&(a=!1);var r=!0;if(t._JT_findAttr(s)._JT_each(function(e){var t,n=(t=e)._JT_hasClass("jet-unpass")?(null!=J&&J(t,t._JT_val()),t._JT_val()):f(t,!1);"true"!=n&&(r=!1,a&&(l[l.length]={obj:e,error:n}))}),r)null!=e.pass&&u._checkFunction(e.pass)(t);else{a&&u._checkFunction(e.fail)(l,t);var n="CHINESE"==Jet.valid.__lang?"输入有误，请按提示改正。":"Values is not expected";Jet.valid.useAlert?alert(n):Jet.valid.useJUI&&JUI.msg.error(n)}}function o(e){var t=0;if(-1!=e.indexOf("range")?t=6:-1!=e.indexOf("letterStart")?t=12:-1!=e.indexOf("length")?t=7:e._JT_has("number")&&"number"!=e&&(t=7),0==t)return p(e);var n=e.substring(t,e.length-1).split(",");return void 0===n[1]&&(n[1]=n[0]),p(e.substring(0,t-1),n)}function p(e,t){if("CHINESE"==Jet.valid.__lang){if(null==t)return e._JT_has("express")?Jet.valid.validText.CN.express:Jet.valid.validText.CN[e];var n="";return e._JT_has("number")&&(n=" 且长度为"),t[0]==t[1]?Jet.valid.validText.CN[e]+n+t[0]:Jet.valid.validText.CN[e]+n+"["+t[0]+","+t[1]+"]"}if(null==t)return e._JT_has("express")?Jet.valid.validText.EN.express:Jet.valid.validText.EN[e];n="";return e._JT_has("number")&&(n=" and length between"),t[0]==t[1]?Jet.valid.validText.EN[e]+n+t[0]:Jet.valid.validText.EN[e]+n+"["+t[0]+","+t[1]+"]"}function c(e){var t=-1,n=-1;if(-1!=e.indexOf("length")){var l=e.substring(7,e.length-1).split(",");e="length",t=l[0],null==l[1]&&(l[1]=l[0]),n=l[1]}else if(-1!=e.indexOf("letterStart")){l=e.substring(12,e.length-1).split(",");e="letterStart",t=l[0],null==l[1]&&(l[1]=l[0]),n=l[1]}else if(e._JT_has("number")&&"number"!=e){l=e.substring(7,e.length-1).split(",");e="number",t=l[0],null==l[1]&&(l[1]=l[0]),n=l[1]}else e._JT_has("express")&&(t=e.substring(8,e.length-1),e="express");if(e in Jet.valid.regExp)return Jet.valid.regExp[e];switch(e){case"number":return 0<=t?new RegExp("^-?(\\d{"+t+","+n+"})$"):/^-?(\d+)$/;case"letterStart":return new RegExp("^([a-zA-Z]([a-zA-Z\\d]){"+(parseInt(t)-1)+","+(parseInt(n)-1)+"})$");case"length":return new RegExp("^(([a-zA-Z\\d]){"+t+","+n+"})$");case"express":return new RegExp(t);default:return"null"}}function T(e,t){var n=e.substring(6,e.length-1).split(",");return c(e="number").test(t)?parseInt(t)<parseInt(n[0])||parseInt(t)>parseInt(n[1])?p("range",n):"true":p("number")}Jet.valid={init:function(e){(null==(e=u._getJdomEle(e))?i.attr(s):e._JT_hasAttr(s)?e:e._JT_findAttr(s))._JT_each(function(e){e.__valided||(e._JT_on({blur:"Jet.valid.validInput(this,true,true)",input:function(){Jet.valid.useOnInput&&Jet.valid.validInput(this,!0,!0)},focus:"Jet.valid.addValidValue(this)"},!0).__valided=!0,Jet.valid.__placeholder&&e._JT_attr("placeholder",o(e._JT_attr(s))))})},findValidPar:function(e){for(var t=e._JT_parent();!t._JT_hasAttr(_)&&null!=t._JT_parent();)t=t._JT_parent();return t},regExp:{null:/^\S{0}$/,date:/^(([12]\d{3}-((0[1-9])|(1[0-2]))-((0[1-9])|([1-2]\d)|3(0|1))))$/,email:/^((\w*@\w*\.[A-Za-z.]+(\.)?[A-Za-z]+))$/,decimal:/^-?[1-9]\d*.\d*|0.\d*[1-9]\d*$/,idcard:/^(\d{17}(X|\d))$/,url:/^((https|http|ftp|rtsp|mms)?:\/\/)[^\s]+$/,phone:/^([1]\d{10})$/},validText:{CN:{nul:"*可以为空",notnull:"*必填",date:"*格式为XXXX-XX-XX",email:"*格式为XXX@XX.XX",number:"*须为纯数字",idcard:"*17位数字加一位数字或X",length:"*输入长度为",url:"*请输入正确的网址",decimal:"*请正确的小数",lengthOfAny:"*输入长度为",phone:"*须为11位纯数字",letterStart:"*字母开头且长度为",range:"*数字不在范围内",express:"*自定义错误"},EN:{nul:"*null is allowed",notnull:"*Required",date:"*format:XXXX-XX-XX",email:"*format:XXX@XX.XX",number:"*expect a number",idcard:"*17 numbers plus a number or X",length:"*length between",url:"*Expect an url name",decimal:"*Expect a float number",lengthOfAny:"*length between",phone:"*must be 11 digits",letterStart:"*letter start and length",range:"*not in range",express:"*wrong express"}},__lang:"CHINESE",__default:!0,__placeholder:!1,__useJUI:!1,__useOnInput:!1,useAlert:!1,validate:l,addValidText:function(e,t){if("json"==i.type(e)&&null==t)for(var n in e)Jet.valid.addValidText(n,e[n]);else"CHINESE"==Jet.valid.__lang?Jet.valid.validText.CN[e]=t:Jet.valid.validText.EN[e]=t},addRegExp:function(e,t,n){"string"==typeof t&&(t=new RegExp(t)),Jet.valid.regExp[e]=t,void 0!==n&&Jet.valid.addValidText(e,n)},validInput:f,addValidValue:function(e){e._JT_hasClass("jet-unpass")&&(e._JT_content(e._JT_validValue),v(e))},clearValid:function(e){(e=u._getJdomEle(e))._JT_hasAttr(s)?t(e):e._JT_findAttr(s)._JT_each(function(e){t(e)})},resetValid:function(e){(e=u._getJdomEle(e))._JT_hasAttr(s)?n(e):e._JT_findAttr(s)._JT_each(function(e){n(e)})},addValid:function(e,t){(e=u._getJdomEle(e))._JT_attr(s,t),Jet.valid.init(e)},onOnePass:function(e){d=u._checkFunction(e)},onOneFail:function(e){J=u._checkFunction(e)}},Object.defineProperties(Jet.valid,{language:{get:function(){return Jet.valid.__lang},set:function(e){Jet.valid.__lang=e.toUpperCase()}},useJUI:{get:function(){return Jet.valid.__useJUI},set:function(e){"undefined"!=typeof JUI&&(Jet.valid.__useJUI=e)}},useDefaultStyle:{get:function(){return Jet.valid.__default},set:function(e){Jet.valid.__default!==e&&(!0===Jet.valid.__useOnInput&&!0===e?_warn("useOnInput 模式下不可使用默认样式"):(Jet.valid.__default=e,!1===(Jet.valid.__lastUseDef=e)&&i.cls("jet-unpass")._JT_each(function(e){v(e),e._JT_removeClass("jet-unpass")._JT_val(e._JT_validValue),e._JT_validValue=void 0})))}},useOnInput:{get:function(){return Jet.valid.__useOnInput},set:function(e){Jet.valid.__useOnInput!==e&&(!1===(Jet.valid.__useOnInput=e)?Jet.valid.__default!==Jet.valid.__lastUseDef&&(Jet.valid.useDefaultStyle=Jet.valid.__lastUseDef):Jet.valid.useDefaultStyle&&(Jet.valid.useDefaultStyle=!1,Jet.valid.__lastUseDef=!0))}},showInPlaceHolder:{get:function(){return Jet.valid.__placeholder},set:function(e){!0===(Jet.valid.__placeholder=e)?i.attr(s)._JT_each(function(e){e._JT_attr("placeholder",o(e._JT_attr(s)))}):!1===e&&i.attr(s)._JT_each(function(e){e._JT_removeAttr("placeholder")})}}}),Jet.valid.init(),HTMLElement.prototype._JT_validate=function(e,t){l({ele:this,pass:e,fail:t})}}();